var k=Object.create;var a=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var n in t)a(e,n,{get:t[n],enumerable:!0})},m=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of L(t))!D.call(e,r)&&r!==n&&a(e,r,{get:()=>t[r],enumerable:!(o=A(t,r))||o.enumerable});return e};var y=(e,t,n)=>(n=e!=null?k(B(e)):{},m(t||!e||!e.__esModule?a(n,"default",{value:e,enumerable:!0}):n,e)),w=e=>m(a({},"__esModule",{value:!0}),e);var j={};M(j,{default:()=>C});module.exports=w(j);var R=require("@parcel/plugin"),h=y(require("fs")),s=y(require("path"));var p=typeof globalThis.process<"u"?globalThis.process.argv:[];var _=()=>typeof globalThis.process<"u"?globalThis.process.env:{};var F=new Set(p),f=e=>F.has(e),G=p.filter(e=>e.startsWith("--")&&e.includes("=")).map(e=>e.split("=")).reduce((e,[t,n])=>(e[t]=n,e),{});var X=f("--dry-run"),l=()=>f("--verbose")||_().VERBOSE==="true",z=l();var W=(e="",...t)=>console.log(e.padEnd(9),"|",...t);var N=0,d=(...e)=>l()&&W(`\u{1F7E1} ${N++}`,...e);var v=["page-runtime","script-runtime","background-service-runtime"];var T=v.reduce((e,t)=>({...e,[t]:h.default.readFileSync(s.default.join(__dirname,`./runtimes/${t}.js`),"utf8")}),{}),C=new R.Runtime({async loadConfig({config:e}){let t=await e.getConfigFrom((0,s.join)(process.env.PLASMO_PROJECT_DIR,"lab"),["package.json"],{exclude:!0}).then(o=>o?.contents);return{hasReact:!!t?.dependencies?.react||!!t?.devDependencies?.react}},apply({bundle:e,options:t,config:n,bundleGraph:o}){if(e.name==="manifest.json"){if(e.getMainEntry()?.meta.webextEntry!==!0)return;let u=[];return o.traverseBundles(O=>{u.push(O.id)},e),{filePath:__filename,code:JSON.stringify(u),isEntry:!0}}if(e.type!=="js"||!t.hmrOptions||e.env.isLibrary||e.env.isWorklet()||t.mode!=="development"||e.env.sourceType==="script")return;let r=e.getMainEntry().filePath,b=r.includes(".plasmo"),i=r.startsWith((0,s.join)(process.env.PLASMO_SRC_DIR,"background"))||r.endsWith((0,s.join)("static","background","index.ts"))||r.endsWith("plasmo-default-background.ts");if(!(b||i||r.startsWith((0,s.join)(process.env.PLASMO_SRC_DIR,"content"))))return;d("@plasmohq/parcel-runtime");let x=n.hasReact&&r.endsWith(".tsx"),P=(0,s.basename)(r).split(".")[0],g=(0,s.dirname)(r).endsWith("contents")||P==="content",c=i?"background-service-runtime":g?"script-runtime":"page-runtime";d("Injecting <<",c,">> for",e.displayName,e.id,r);let E={isContentScript:g,isBackground:i,isReact:x,runtimes:[c],...t.hmrOptions,entryFilePath:String.raw`${r}`,bundleId:e.id,envHash:e.env.id,verbose:process.env.VERBOSE,secure:!!(t.serveOptions&&t.serveOptions.https),serverPort:t.serveOptions&&t.serveOptions.port},S=T[c].replace("__plasmo_runtime_data__",JSON.stringify(E));return{filePath:__filename,code:S,isEntry:!0,env:{sourceType:"module"}}}});0&&(module.exports={});
